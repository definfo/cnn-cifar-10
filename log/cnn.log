[Backend] Using CuPy (GPU)
[INFO] Loading CIFAR-10 from data/cifar-10-batches-py ...
[INFO] Training set: (50000, 3, 32, 32), Test set: (10000, 3, 32, 32)
[INFO] Using default learning rate: 0.02
[INFO] Using default optimizer: SGD
[INFO] Using default dropout rate: 0.6
[INFO] Using recommended epochs for cnn: 40
[INFO] Using default warmup epochs: 6
[INFO] Using cosine learning rate schedule with 6 warmup epochs
[INFO] Using SimpleCNN model with SGD optimizer
[INFO] Hyperparameters: lr=0.02, dropout=0.6, epochs=40
[INFO] Model: SimpleCNN, Parameters: 668,884
[INFO] Starting epoch 1/40
Epoch 1:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 1] Learning rate: 0.003333
[Epoch 1] Average Loss: 2.2364                                                  
[Test] Accuracy: 2467/10000 (24.67%)
[Checkpoint] Model saved to checkpoint/cnn_epoch1.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 2/40
Epoch 2:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 2] Learning rate: 0.006667
[Epoch 2] Average Loss: 1.9525                                                  
[Test] Accuracy: 3449/10000 (34.49%)
[Checkpoint] Model saved to checkpoint/cnn_epoch2.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 3/40
Epoch 3:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 3] Learning rate: 0.010000
[Epoch 3] Average Loss: 1.7608                                                  
[Test] Accuracy: 3195/10000 (31.95%)
[Checkpoint] Model saved to checkpoint/cnn_epoch3.pkl
[INFO] Starting epoch 4/40
Epoch 4:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 4] Learning rate: 0.013333
[Epoch 4] Average Loss: 1.6165                                                  
[Test] Accuracy: 4094/10000 (40.94%)
[Checkpoint] Model saved to checkpoint/cnn_epoch4.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 5/40
Epoch 5:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 5] Learning rate: 0.016667
[Epoch 5] Average Loss: 1.5215                                                  
[Test] Accuracy: 4468/10000 (44.68%)
[Checkpoint] Model saved to checkpoint/cnn_epoch5.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 6/40
Epoch 6:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 6] Learning rate: 0.020000
[Epoch 6] Average Loss: 1.4286                                                  
[Test] Accuracy: 4949/10000 (49.49%)
[Checkpoint] Model saved to checkpoint/cnn_epoch6.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 7/40
Epoch 7:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 7] Learning rate: 0.020000
[Epoch 7] Average Loss: 1.3448                                                  
[Test] Accuracy: 4971/10000 (49.71%)
[Checkpoint] Model saved to checkpoint/cnn_epoch7.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 8/40
Epoch 8:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 8] Learning rate: 0.019957
[Epoch 8] Average Loss: 1.2736                                                  
[Test] Accuracy: 4713/10000 (47.13%)
[Checkpoint] Model saved to checkpoint/cnn_epoch8.pkl
[INFO] Starting epoch 9/40
Epoch 9:   0%|                                          | 0/782 [00:00<?, ?it/s][Epoch 9] Learning rate: 0.019830
[Epoch 9] Average Loss: 1.2179                                                  
[Test] Accuracy: 5464/10000 (54.64%)
[Checkpoint] Model saved to checkpoint/cnn_epoch9.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 10/40
Epoch 10:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 10] Learning rate: 0.019618
[Epoch 10] Average Loss: 1.1641                                                 
[Test] Accuracy: 5277/10000 (52.77%)
[Checkpoint] Model saved to checkpoint/cnn_epoch10.pkl
[INFO] Starting epoch 11/40
Epoch 11:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 11] Learning rate: 0.019325
[Epoch 11] Average Loss: 1.1237                                                 
[Test] Accuracy: 5563/10000 (55.63%)
[Checkpoint] Model saved to checkpoint/cnn_epoch11.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 12/40
Epoch 12:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 12] Learning rate: 0.018952
[Epoch 12] Average Loss: 1.0828                                                 
[Test] Accuracy: 5486/10000 (54.86%)
[Checkpoint] Model saved to checkpoint/cnn_epoch12.pkl
[INFO] Starting epoch 13/40
Epoch 13:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 13] Learning rate: 0.018502
[Epoch 13] Average Loss: 1.0443                                                 
[Test] Accuracy: 5130/10000 (51.30%)
[Checkpoint] Model saved to checkpoint/cnn_epoch13.pkl
[INFO] Starting epoch 14/40
Epoch 14:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 14] Learning rate: 0.017980
[Epoch 14] Average Loss: 1.0118                                                 
[Test] Accuracy: 5823/10000 (58.23%)
[Checkpoint] Model saved to checkpoint/cnn_epoch14.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 15/40
Epoch 15:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 15] Learning rate: 0.017390
[Epoch 15] Average Loss: 0.9803                                                 
[Test] Accuracy: 5476/10000 (54.76%)
[Checkpoint] Model saved to checkpoint/cnn_epoch15.pkl
[INFO] Starting epoch 16/40
Epoch 16:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 16] Learning rate: 0.016737
[Epoch 16] Average Loss: 0.9554                                                 
[Test] Accuracy: 6268/10000 (62.68%)
[Checkpoint] Model saved to checkpoint/cnn_epoch16.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 17/40
Epoch 17:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 17] Learning rate: 0.016027
[Epoch 17] Average Loss: 0.9264                                                 
[Test] Accuracy: 4780/10000 (47.80%)
[Checkpoint] Model saved to checkpoint/cnn_epoch17.pkl
[INFO] Starting epoch 18/40
Epoch 18:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 18] Learning rate: 0.015265
[Epoch 18] Average Loss: 0.8980                                                 
[Test] Accuracy: 5973/10000 (59.73%)
[Checkpoint] Model saved to checkpoint/cnn_epoch18.pkl
[INFO] Starting epoch 19/40
Epoch 19:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 19] Learning rate: 0.014458
[Epoch 19] Average Loss: 0.8758                                                 
[Test] Accuracy: 6165/10000 (61.65%)
[Checkpoint] Model saved to checkpoint/cnn_epoch19.pkl
[INFO] Starting epoch 20/40
Epoch 20:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 20] Learning rate: 0.013613
[Epoch 20] Average Loss: 0.8511                                                 
[Test] Accuracy: 6142/10000 (61.42%)
[Checkpoint] Model saved to checkpoint/cnn_epoch20.pkl
[INFO] Starting epoch 21/40
Epoch 21:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 21] Learning rate: 0.012737
[Epoch 21] Average Loss: 0.8277                                                 
[Test] Accuracy: 6138/10000 (61.38%)
[Checkpoint] Model saved to checkpoint/cnn_epoch21.pkl
[INFO] Starting epoch 22/40
Epoch 22:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 22] Learning rate: 0.011838
[Epoch 22] Average Loss: 0.8054                                                 
[Test] Accuracy: 6207/10000 (62.07%)
[Checkpoint] Model saved to checkpoint/cnn_epoch22.pkl
[INFO] Starting epoch 23/40
Epoch 23:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 23] Learning rate: 0.010923
[Epoch 23] Average Loss: 0.7825                                                 
[Test] Accuracy: 6386/10000 (63.86%)
[Checkpoint] Model saved to checkpoint/cnn_epoch23.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 24/40
Epoch 24:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 24] Learning rate: 0.010000
[Epoch 24] Average Loss: 0.7634                                                 
[Test] Accuracy: 6315/10000 (63.15%)
[Checkpoint] Model saved to checkpoint/cnn_epoch24.pkl
[INFO] Starting epoch 25/40
Epoch 25:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 25] Learning rate: 0.009078
[Epoch 25] Average Loss: 0.7451                                                 
[Test] Accuracy: 6363/10000 (63.63%)
[Checkpoint] Model saved to checkpoint/cnn_epoch25.pkl
[INFO] Starting epoch 26/40
Epoch 26:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 26] Learning rate: 0.008163
[Epoch 26] Average Loss: 0.7282                                                 
[Test] Accuracy: 6438/10000 (64.38%)
[Checkpoint] Model saved to checkpoint/cnn_epoch26.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 27/40
Epoch 27:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 27] Learning rate: 0.007264
[Epoch 27] Average Loss: 0.7110                                                 
[Test] Accuracy: 6325/10000 (63.25%)
[Checkpoint] Model saved to checkpoint/cnn_epoch27.pkl
[INFO] Starting epoch 28/40
Epoch 28:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 28] Learning rate: 0.006388
[Epoch 28] Average Loss: 0.6952                                                 
[Test] Accuracy: 6391/10000 (63.91%)
[Checkpoint] Model saved to checkpoint/cnn_epoch28.pkl
[INFO] Starting epoch 29/40
Epoch 29:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 29] Learning rate: 0.005543
[Epoch 29] Average Loss: 0.6814                                                 
[Test] Accuracy: 6564/10000 (65.64%)
[Checkpoint] Model saved to checkpoint/cnn_epoch29.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 30/40
Epoch 30:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 30] Learning rate: 0.004736
[Epoch 30] Average Loss: 0.6674                                                 
[Test] Accuracy: 6423/10000 (64.23%)
[Checkpoint] Model saved to checkpoint/cnn_epoch30.pkl
[INFO] Starting epoch 31/40
Epoch 31:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 31] Learning rate: 0.003974
[Epoch 31] Average Loss: 0.6559                                                 
[Test] Accuracy: 6582/10000 (65.82%)
[Checkpoint] Model saved to checkpoint/cnn_epoch31.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 32/40
Epoch 32:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 32] Learning rate: 0.003264
[Epoch 32] Average Loss: 0.6455                                                 
[Test] Accuracy: 6509/10000 (65.09%)
[Checkpoint] Model saved to checkpoint/cnn_epoch32.pkl
[INFO] Starting epoch 33/40
Epoch 33:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 33] Learning rate: 0.002611
[Epoch 33] Average Loss: 0.6360                                                 
[Test] Accuracy: 6573/10000 (65.73%)
[Checkpoint] Model saved to checkpoint/cnn_epoch33.pkl
[INFO] Starting epoch 34/40
Epoch 34:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 34] Learning rate: 0.002021
[Epoch 34] Average Loss: 0.6285                                                 
[Test] Accuracy: 6584/10000 (65.84%)
[Checkpoint] Model saved to checkpoint/cnn_epoch34.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 35/40
Epoch 35:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 35] Learning rate: 0.001499
[Epoch 35] Average Loss: 0.6222                                                 
[Test] Accuracy: 6566/10000 (65.66%)
[Checkpoint] Model saved to checkpoint/cnn_epoch35.pkl
[INFO] Starting epoch 36/40
Epoch 36:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 36] Learning rate: 0.001049
[Epoch 36] Average Loss: 0.6172                                                 
[Test] Accuracy: 6581/10000 (65.81%)
[Checkpoint] Model saved to checkpoint/cnn_epoch36.pkl
[INFO] Starting epoch 37/40
Epoch 37:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 37] Learning rate: 0.000676
[Epoch 37] Average Loss: 0.6128                                                 
[Test] Accuracy: 6590/10000 (65.90%)
[Checkpoint] Model saved to checkpoint/cnn_epoch37.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 38/40
Epoch 38:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 38] Learning rate: 0.000383
[Epoch 38] Average Loss: 0.6095                                                 
[Test] Accuracy: 6598/10000 (65.98%)
[Checkpoint] Model saved to checkpoint/cnn_epoch38.pkl
[DEBUG] Checkpoint path: checkpoint/cnn_best.pkl
[Checkpoint] Model saved to checkpoint/cnn_best.pkl
[INFO] New best model saved: checkpoint/cnn_best.pkl
[INFO] Starting epoch 39/40
Epoch 39:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 39] Learning rate: 0.000171
[Epoch 39] Average Loss: 0.6075                                                 
[Test] Accuracy: 6593/10000 (65.93%)
[Checkpoint] Model saved to checkpoint/cnn_epoch39.pkl
[INFO] Starting epoch 40/40
Epoch 40:   0%|                                         | 0/782 [00:00<?, ?it/s][Epoch 40] Learning rate: 0.000044
[Epoch 40] Average Loss: 0.6063                                                 
[Test] Accuracy: 6589/10000 (65.89%)
[Checkpoint] Model saved to checkpoint/cnn_epoch40.pkl
[RESULT] Best test accuracy: 65.98% (model: checkpoint/cnn_best.pkl)
